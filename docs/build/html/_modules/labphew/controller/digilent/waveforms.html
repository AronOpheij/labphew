

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>labphew.controller.digilent.waveforms &mdash; labphew 0.3.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> labphew
          

          
          </a>

          
            
            
              <div class="version">
                0.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Further in the docs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction to labphew</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">How to install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../howtolabphew.html">How to labphew</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../walkthrough.html">A short guided tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../labphew.model.html">M for model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../labphew.view.html">V for view</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../labphew.controller.html">C for controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../labphew.core.html">The core files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../labphew.logging.html">Logging and debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples.html">Simple examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../devices.html">Supported devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../customize.html">Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api.html">API documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">labphew</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>labphew.controller.digilent.waveforms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for labphew.controller.digilent.waveforms</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">=============================</span>
<span class="sd">Digilent WaveForms Controller</span>
<span class="sd">=============================</span>

<span class="sd">This module is made to control `Digilent WaveForms &lt;https://store.digilentinc.com/waveforms-download-only/&gt;`_ compatible devices.</span>
<span class="sd">It is developed with the `Analog Discovery 2 &lt;https://reference.digilentinc.com/reference/instrumentation/analog-discovery-2/start&gt;`_ but probably also works for the other devices.</span>

<span class="sd">It depends on `Digilent&#39;s DWF library wrapper &lt;https://pypi.org/project/dwf/&gt;`_ (pip install dwf) which provides a pythonic way of interacting with the WaveForms dll.</span>
<span class="sd">The DfwController class inherits from the Dwf class of the dwf module, meaning all functionality of Dwf is available.</span>
<span class="sd">In addition the input and output channels are made available internally and basic methods are added to read and write analog values.</span>
<span class="sd">The example code at the end shows both examples of using these basic methods and of interacting with the more complex inherited methods.</span>

<span class="sd">Unfortunately there&#39;s no extended documentation for the dwf module, but original functions to interact with the dll are</span>
<span class="sd">described in the `WaveForms SDK Reference Manual &lt;https://s3-us-west-2.amazonaws.com/digilent/resources/instrumentation/waveforms/waveforms_sdk_rm.pdf&gt;`_.</span>
<span class="sd">Using an autocompleting IDE it&#39;s possible to explore the available methods and find the documentation of the corresponding functions in the WaveForms SDK Reference Manual.</span>

<span class="sd">In addition to the DfwController class this module contains functions to explore which devices are connected and to close connections.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">dwf</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<div class="viewcode-block" id="DfwController"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.DfwController">[docs]</a><span class="k">class</span> <span class="nc">DfwController</span><span class="p">(</span><span class="n">dwf</span><span class="o">.</span><span class="n">Dwf</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controller for Digilent devices controlled through WaveForms software</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="DfwController.__init__"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.DfwController.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connect to device with optional configuration.</span>

<span class="sd">        It connects to device with device_number as listed by the enumerate_devices() function of this module.</span>
<span class="sd">        Note that the default value of 0 will simply connect to the first device found.</span>
<span class="sd">        The possible configurations are also returned by enumerate_devices(). Note that enumerate devices is run at time</span>
<span class="sd">        of module import and stored in the variable devices. Note that the information returned by enumerate_devices()</span>
<span class="sd">        (or stored in the variable devices) can be diplayed in more readable form with the function print_device_list()</span>
<span class="sd">        of this module.</span>

<span class="sd">        :param device_number: the device number (default: 0)</span>
<span class="sd">        :type device_number: int</span>
<span class="sd">        :param config: configuration number (default: 0)</span>
<span class="sd">        :type config: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">device_number</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogIn</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DwfAnalogIn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogOut</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DwfAnalogOut</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DigitalIn</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DwfDigitalIn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DigitalOut</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DwfDigitalOut</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Not sure yet what these do:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogIO</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DwfAnalogIO</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DigitalIO</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DwfDigitalIO</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># create short name references</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AnalogIn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AnalogOut</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">di</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DigitalIn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DigitalOut</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">basic_analog_return_std</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># will be overwritten by preset_basic_analog()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_timeout</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># will be overwritten by preset_basic_analog()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_ao0</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># will be overwritten by write_analog()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_ao1</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># will be overwritten by write_analog()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time_stabilized</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>  <span class="c1"># will be overwritten by write_analog()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preset_basic_analog</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;DfwController object created&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DfwController.preset_basic_analog"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.DfwController.preset_basic_analog">[docs]</a>    <span class="k">def</span> <span class="nf">preset_basic_analog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply settings for read_analog() and write_analog()</span>
<span class="sd">        Please note that there may be a significant overhead (delay) for reading which seems to be larger for lower</span>
<span class="sd">        frequencies and oddly seems to be larger for collecting a small number of points.</span>
<span class="sd">        The default values of averaging over 82 points at 10kHz results in &lt;10ms per averaged datapoint.</span>

<span class="sd">        :param n:     number of datapoints to collect and average (default 85)</span>
<span class="sd">        :type n:      int</span>
<span class="sd">        :param freq:  analog in frequency (default 10000)</span>
<span class="sd">        :type freq:   int or float or None</span>
<span class="sd">        :param range: the voltage range for the ADC (5.0 or 50.0) (default 50.0)</span>
<span class="sd">        :type range:  int or float or None</span>
<span class="sd">        :param return_std: also returns the standard deviations (default False)</span>
<span class="sd">        :type return_std:  bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeFunctionSet</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">CARRIER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">FUNC</span><span class="o">.</span><span class="n">DC</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># apply</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">bufferSizeSet</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">frequencySet</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">channelRangeSet</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># apply config to AI, but not start</span>
        <span class="c1"># self._read_timeout = 1.9 + self.ai.bufferSizeGet() / self.ai.frequencyGet()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basic_analog_return_std</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="DfwController.stop_analog_out"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.DfwController.stop_analog_out">[docs]</a>    <span class="k">def</span> <span class="nf">stop_analog_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basic method to stop analog output.</span>

<span class="sd">        :param channel: analog out channel to stop (default is -1, meaning all channels)</span>
<span class="sd">        :type channel: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="DfwController.write_analog"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.DfwController.write_analog">[docs]</a>    <span class="k">def</span> <span class="nf">write_analog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volt</span><span class="p">,</span> <span class="n">channel</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basic method to apply voltage to analog out channels.</span>
<span class="sd">        In the background it also approximates the timestamp when the output will be stabilize (based on the change in voltage applied).</span>
<span class="sd">        To wait for that timestamp, call wait_for_stabilization()</span>

<span class="sd">        :param volt: voltage to apply (in Volt)</span>
<span class="sd">        :type vol: float</span>
<span class="sd">        :param channel: analog out channel to set (default is -1, meaning all channels)</span>
<span class="sd">        :type channel: int</span>
<span class="sd">        :param delay: delay (s) to wait after setting output to allow for stabilization</span>
<span class="sd">        :type delay: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeOffsetSet</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">CARRIER</span><span class="p">,</span> <span class="n">volt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">enable</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">channel</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">channel</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time_stabilized</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time_stabilized</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">+</span><span class="mf">0.013</span><span class="o">+</span><span class="mf">0.005</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_ao0</span><span class="o">-</span><span class="n">volt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_ao0</span> <span class="o">=</span> <span class="n">volt</span>
        <span class="k">if</span> <span class="n">channel</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">channel</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time_stabilized</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time_stabilized</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">+</span><span class="mf">0.013</span><span class="o">+</span><span class="mf">0.005</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_ao1</span><span class="o">-</span><span class="n">volt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_ao1</span> <span class="o">=</span> <span class="n">volt</span></div>

<div class="viewcode-block" id="DfwController.wait_for_stabilization"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.DfwController.wait_for_stabilization">[docs]</a>    <span class="k">def</span> <span class="nf">wait_for_stabilization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Waits for the output to stabilize. Note that this is calculated and approximated, not actively measured or verified.</span>

<span class="sd">        :return: the amount of time waited (s)</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_stabilized</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">wait</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">wait</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">wait</span>
        <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="DfwController.read_analog"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.DfwController.read_analog">[docs]</a>    <span class="k">def</span> <span class="nf">read_analog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basic method to read voltage of analog in channels.</span>
<span class="sd">        See preset_basic_analog() to setup specifics for reading.</span>
<span class="sd">        Returns both channels.</span>
<span class="sd">        (Also returns standard deviations if self.basic_analog_return_std is True)</span>

<span class="sd">        :return: the analog values of both AI channels (and possibly the standard deviations)</span>
<span class="sd">        :rtype: float, float [,float, float] (or None&#39;s in case of read timeout)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># start acquisition</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_for_ai_acquisition</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">basic_analog_return_std</span><span class="p">)</span>  <span class="c1"># return the right amount of None&#39;s</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">bufferSizeGet</span><span class="p">()</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">statusData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">))</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">statusData</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">buf</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basic_analog_return_std</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c0</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">c1</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">c0</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">c1</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c0</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">c1</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span></div>

<div class="viewcode-block" id="DfwController.wait_for_ai_acquisition"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.DfwController.wait_for_ai_acquisition">[docs]</a>    <span class="k">def</span> <span class="nf">wait_for_ai_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Waits while ai status is busy. Uses the AI frequency and buffersize in combination with start_timestamp to</span>
<span class="sd">        calculate a read timeout. If no start_timestamp is supplied it uses time at moment of calling the method.</span>
<span class="sd">        It returns True if timeout occurred and None if acquisition finished regularly.</span>

<span class="sd">        :param start_timestamp: the timestamp (as returned by time.time()) from which to calculate how long to wait</span>
<span class="sd">        :type start_timestamp: float or None</span>
<span class="sd">        :return: True for timeout, None when nothing happened</span>
<span class="sd">        :rtype: True or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start_timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">read_timeout</span> <span class="o">=</span> <span class="mf">1.9</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">bufferSizeGet</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">frequencyGet</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">STATE</span><span class="o">.</span><span class="n">DONE</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">start_timestamp</span> <span class="o">+</span> <span class="n">read_timeout</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;AI read timeout occured&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="SimulatedDfwController"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.SimulatedDfwController">[docs]</a><span class="k">class</span> <span class="nc">SimulatedDfwController</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rudimentary simulated version of DfwController for the purpose of developing without a connected device.</span>
<span class="sd">    Note that it is far from a complete simulation, it just mimics a few basic methods.</span>
<span class="sd">    You can add any simulation function to relate read_analog() to a value set with write_analog() via _analog_simulation_functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="SimulatedDfwController.__init__"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.SimulatedDfwController.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_analog_in_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># empty dictionary to hold simulated analog values</span>
        <span class="c1"># self._analog_simulation_functions = [lambda v: np.exp(v-0.7)/20, lambda v: np.random.normal(1,.5)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_analog_simulation_functions</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">/</span> <span class="mi">20</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basic_analog_return_std</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

        <span class="k">class</span> <span class="nc">Dummy</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;A dummy class that allows &quot;Setting&quot; and &quot;Getting&quot; arbitrary values and doesn&#39;t crash for unknown values.&quot;&quot;&quot;</span>
            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="n">s2</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">s2</span><span class="o">.</span><span class="n">getset</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>

            <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;Set&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">s2</span><span class="o">.</span><span class="n">getset</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;Set&#39;</span><span class="p">)])</span><span class="o">+</span><span class="n">args</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="s1">&#39;Get&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">s2</span><span class="o">.</span><span class="n">getset</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;Get&#39;</span><span class="p">)])</span><span class="o">+</span><span class="n">args</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogIn</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogIn</span><span class="o">.</span><span class="n">statusData</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ch</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogOut</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogOut</span><span class="o">.</span><span class="n">NODE</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="n">CARRIER</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">FM</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">AM</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogOut</span><span class="o">.</span><span class="n">FUNC</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="n">DC</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">SINE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">SQUARE</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">TRIANGLE</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">RAMP_UP</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">RAMP_DOWN</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">NOISE</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">CUSTOM</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">PLAY</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DigitalIn</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DigitalOut</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AnalogIO</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DigitalIO</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
        <span class="c1"># create short name references</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AnalogIn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ao</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AnalogOut</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">di</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DigitalIn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DigitalOut</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;SimulatedDfwController object created&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method is called when an undefined method is called&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;method </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> is not implemented (in SimulatedDfwController)&#39;</span><span class="p">)</span>

    <span class="c1"># When running in PyCharm console, __len__ gets called and will result in the method above printing warnings.</span>
    <span class="c1"># Hence it&#39;s implemented here as an empty method</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="SimulatedDfwController.read_analog"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.SimulatedDfwController.read_analog">[docs]</a>    <span class="k">def</span> <span class="nf">read_analog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulated version of read_analog().</span>
<span class="sd">        Applies functions specified in self._analog_simulation_functions (optionally to the values set by write_analog() ).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">func</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analog_simulation_functions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analog_in_values</span><span class="p">)]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basic_analog_return_std</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="n">results</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">)</span></div>

<div class="viewcode-block" id="SimulatedDfwController.write_analog"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.SimulatedDfwController.write_analog">[docs]</a>    <span class="k">def</span> <span class="nf">write_analog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volt</span><span class="p">,</span> <span class="n">channel</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulated version of write_analog().</span>

<span class="sd">        :param volt:</span>
<span class="sd">        :type volt:</span>
<span class="sd">        :param channel:</span>
<span class="sd">        :type channel:</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">channel</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">channel</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_analog_in_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">volt</span>
        <span class="k">if</span> <span class="n">channel</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">channel</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_analog_in_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">volt</span></div>

<div class="viewcode-block" id="SimulatedDfwController.wait_for_ai_acquisition"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.SimulatedDfwController.wait_for_ai_acquisition">[docs]</a>    <span class="k">def</span> <span class="nf">wait_for_ai_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulated version of wait_for_ai_acquisition().</span>

<span class="sd">        :param start_timestamp: is ignored in simulated version</span>
<span class="sd">        :type start_timestamp: float or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span></div>

<div class="viewcode-block" id="SimulatedDfwController.wait_for_stabilization"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.SimulatedDfwController.wait_for_stabilization">[docs]</a>    <span class="k">def</span> <span class="nf">wait_for_stabilization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulated version of wait_for_stabilization(). Waits for 0.1s.&quot;&quot;&quot;</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span></div>

<div class="viewcode-block" id="SimulatedDfwController.preset_basic_analog"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.SimulatedDfwController.preset_basic_analog">[docs]</a>    <span class="k">def</span> <span class="nf">preset_basic_analog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulated version of preset_basic_analog. Basically does nothing.</span>

<span class="sd">        :param n:     number of datapoints to collect and average (default 85)</span>
<span class="sd">        :type n:      int</span>
<span class="sd">        :param freq:  analog in frequency (default 10000)</span>
<span class="sd">        :type freq:   int or float or None</span>
<span class="sd">        :param range: the voltage range for the ADC (5.0 or 50.0) (default 50.0)</span>
<span class="sd">        :type range:  int or float or None</span>
<span class="sd">        :param return_std: also returns the standard deviations (default False)</span>
<span class="sd">        :type return_std:  bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">frequencySet</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">channelRangeSet</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">range</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basic_analog_return_std</span> <span class="o">=</span> <span class="n">return_std</span></div>

<div class="viewcode-block" id="SimulatedDfwController.close"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.SimulatedDfwController.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div></div>


<div class="viewcode-block" id="close_all"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.close_all">[docs]</a><span class="k">def</span> <span class="nf">close_all</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Close all Digilent &quot;WaveForms&quot; devices&quot;&quot;&quot;</span>
    <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfDeviceCloseAll</span><span class="p">()</span></div>


<div class="viewcode-block" id="enumerate_devices"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.enumerate_devices">[docs]</a><span class="k">def</span> <span class="nf">enumerate_devices</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List connected devices and their possible configurations.</span>
<span class="sd">    Note: Use print_device_list() to easily display the result in readable form.</span>

<span class="sd">    :return: list of dictionaries containing information about the devices found</span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">devices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">last_err_msg</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfGetLastErrorMsg</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">last_err_msg</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">last_err_msg</span><span class="p">)</span>
        <span class="c1"># enumerate devices</span>
        <span class="n">devs</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DwfEnumeration</span><span class="p">()</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ch&#39;</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;buf&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">device</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">devs</span><span class="p">):</span>
            <span class="n">dev_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;configs&#39;</span><span class="p">:</span> <span class="p">[]}</span>
            <span class="n">dev_dict</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;SN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">SN</span><span class="p">()</span>
            <span class="n">dev_dict</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;deviceName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">deviceName</span><span class="p">()</span>
            <span class="n">dev_dict</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;userName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">userName</span><span class="p">()</span>
            <span class="n">dev_dict</span><span class="p">[</span><span class="s1">&#39;dev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span>

            <span class="k">if</span> <span class="n">device</span><span class="o">.</span><span class="n">isOpened</span><span class="p">():</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t connect to device </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">dev_dict</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;SN&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">), a connection is already open.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                                     <span class="s2">&quot;Note that the list was stored in &quot;</span><span class="o">+</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;.devices at the moment of import.&quot;</span><span class="p">)</span>
                <span class="n">dev_dict</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Couldn&#39;t connect to device for further information&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dwf_ai</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DwfAnalogIn</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
                <span class="n">channel</span> <span class="o">=</span> <span class="n">dwf_ai</span><span class="o">.</span><span class="n">channelCount</span><span class="p">()</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">hzFreq</span> <span class="o">=</span> <span class="n">dwf_ai</span><span class="o">.</span><span class="n">frequencyInfo</span><span class="p">()</span>
                <span class="n">dev_dict</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;maxAIfreq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hzFreq</span>
                <span class="n">dwf_ai</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="n">n_configs</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">iCfg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_configs</span><span class="p">):</span>
                    <span class="n">aic</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfigInfo</span><span class="p">(</span><span class="n">iCfg</span><span class="p">,</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DECIAnalogInChannelCount</span><span class="p">)</span>  <span class="c1"># 1</span>
                    <span class="n">aib</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfigInfo</span><span class="p">(</span><span class="n">iCfg</span><span class="p">,</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DECIAnalogInBufferSize</span><span class="p">)</span>  <span class="c1"># 7</span>
                    <span class="n">aoc</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfigInfo</span><span class="p">(</span><span class="n">iCfg</span><span class="p">,</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DECIAnalogOutChannelCount</span><span class="p">)</span>  <span class="c1"># 2</span>
                    <span class="n">aob</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfigInfo</span><span class="p">(</span><span class="n">iCfg</span><span class="p">,</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DECIAnalogOutBufferSize</span><span class="p">)</span>  <span class="c1"># 8</span>
                    <span class="n">dic</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfigInfo</span><span class="p">(</span><span class="n">iCfg</span><span class="p">,</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DECIDigitalInChannelCount</span><span class="p">)</span>  <span class="c1"># 4</span>
                    <span class="n">dib</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfigInfo</span><span class="p">(</span><span class="n">iCfg</span><span class="p">,</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DECIDigitalInBufferSize</span><span class="p">)</span>  <span class="c1"># 9</span>
                    <span class="n">doc</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfigInfo</span><span class="p">(</span><span class="n">iCfg</span><span class="p">,</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DECIDigitalOutChannelCount</span><span class="p">)</span>  <span class="c1"># 5</span>
                    <span class="n">dob</span> <span class="o">=</span> <span class="n">dwf</span><span class="o">.</span><span class="n">FDwfEnumConfigInfo</span><span class="p">(</span><span class="n">iCfg</span><span class="p">,</span> <span class="n">dwf</span><span class="o">.</span><span class="n">DECIDigitalOutBufferSize</span><span class="p">)</span>  <span class="c1"># 10</span>
                    <span class="n">dev_dict</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;ai&#39;</span><span class="p">:</span> <span class="n">ch</span><span class="p">(</span><span class="n">aic</span><span class="p">,</span> <span class="n">aib</span><span class="p">),</span> <span class="s1">&#39;ao&#39;</span><span class="p">:</span> <span class="n">ch</span><span class="p">(</span><span class="n">aoc</span><span class="p">,</span> <span class="n">aob</span><span class="p">),</span> <span class="s1">&#39;di&#39;</span><span class="p">:</span> <span class="n">ch</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="n">dib</span><span class="p">),</span> <span class="s1">&#39;do&#39;</span><span class="p">:</span> <span class="n">ch</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">dob</span><span class="p">)})</span>
                <span class="n">dwf_ai</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">devices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dev_dict</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">exc_info</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Exception occured while enumerating devices:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">devices</span></div>


<span class="c1"># Run enumerate_devices() once when loading the module to make the list available afterwards</span>
<span class="n">devices</span> <span class="o">=</span> <span class="n">enumerate_devices</span><span class="p">()</span>


<div class="viewcode-block" id="print_device_list"><a class="viewcode-back" href="../../../../controller/waveforms.html#labphew.controller.digilent.waveforms.print_device_list">[docs]</a><span class="k">def</span> <span class="nf">print_device_list</span><span class="p">(</span><span class="n">devices_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints the information in the list generated by enumerate_devices() in a readable form.</span>
<span class="sd">    If no argument is given it prints the list stored at time of importing the module.</span>

<span class="sd">    :param devices: the list generated by enumerate_devices() (or None (default) to print the list stored at import)</span>
<span class="sd">    :type devices: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">incomplete</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">devices_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">global</span> <span class="n">devices</span>
        <span class="n">devices_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">devices</span><span class="p">)</span>
        <span class="n">incomplete</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">device</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">devices_list</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Device &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">deviceName:</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;deviceName&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">userName:</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;userName&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">SN:</span><span class="se">\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;SN&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;maxAIfreq&#39;</span> <span class="ow">in</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">maxAIfreq:</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">][</span><span class="s1">&#39;maxAIfreq&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">incomplete</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">incomplete</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Config AnalogIN   AnalogOUT  DigitalIN   DigitalOUT&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iCfg</span><span class="p">,</span> <span class="n">conf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;configs&#39;</span><span class="p">]):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{}</span><span class="s1">      </span><span class="si">{}</span><span class="s1"> x </span><span class="si">{:&lt;5}</span><span class="s1">  </span><span class="si">{}</span><span class="s1"> x </span><span class="si">{:&lt;5}</span><span class="s1">  </span><span class="si">{:2}</span><span class="s1"> x </span><span class="si">{:&lt;5}</span><span class="s1">  </span><span class="si">{:2}</span><span class="s1"> x </span><span class="si">{:&lt;5}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">iCfg</span><span class="p">,</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;ai&#39;</span><span class="p">][</span><span class="s1">&#39;ch&#39;</span><span class="p">],</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;ai&#39;</span><span class="p">][</span><span class="s1">&#39;buf&#39;</span><span class="p">],</span>
                          <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;ao&#39;</span><span class="p">][</span><span class="s1">&#39;ch&#39;</span><span class="p">],</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;ao&#39;</span><span class="p">][</span><span class="s1">&#39;buf&#39;</span><span class="p">],</span>
                          <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;di&#39;</span><span class="p">][</span><span class="s1">&#39;ch&#39;</span><span class="p">],</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;di&#39;</span><span class="p">][</span><span class="s1">&#39;buf&#39;</span><span class="p">],</span>
                          <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;do&#39;</span><span class="p">][</span><span class="s1">&#39;ch&#39;</span><span class="p">],</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;do&#39;</span><span class="p">][</span><span class="s1">&#39;buf&#39;</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">incomplete</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The device list appears to be incomplete. &quot;</span>
              <span class="s2">&quot;Try &quot;</span><span class="o">+</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;.devices_list() without argument to print the list stored at time of import&quot;</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">labphew</span>  <span class="c1"># import this to use labphew style logging (by importing it before matplotlib it also prevents matplotlib from printing many debugs)</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="c1"># Display a list of devices and their possible configurations</span>
    <span class="n">devs</span> <span class="o">=</span> <span class="n">enumerate_devices</span><span class="p">()</span>
    <span class="n">print_device_list</span><span class="p">(</span><span class="n">devs</span><span class="p">)</span>

    <span class="c1"># Create object for device number 0, with config number 0</span>
    <span class="n">daq</span> <span class="o">=</span> <span class="n">DfwController</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># # Use the following line instead of the previous line for testing the simulated device</span>
    <span class="c1"># daq = SimulatedDfwController(0, 0)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">To be able to read signals we&#39;re about to generate: connect W1 to 1+, W2 to 2+, and 1- and 2- to ground (down arrow)&quot;</span><span class="p">)</span>

    <span class="c1"># Example showing basic analog methods:</span>

    <span class="c1"># Apply settings for using basic analog methods.</span>
    <span class="c1"># Note that this is already automatically done at instantiation of the object so technically not required at this moment.</span>
    <span class="c1"># But if you&#39;ve those changed settings (like we&#39;ll do in the advanced example below) it is necessary.</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">preset_basic_analog</span><span class="p">()</span>

    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">daq</span><span class="o">.</span><span class="n">read_analog</span><span class="p">())</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>

    <span class="n">daq</span><span class="o">.</span><span class="n">write_analog</span><span class="p">(</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1">#  1.3V on analog out channel 0</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">write_analog</span><span class="p">(</span><span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># -0.7V on analog out channel 1</span>

    <span class="n">daq</span><span class="o">.</span><span class="n">wait_for_stabilization</span><span class="p">()</span>

    <span class="n">in0</span><span class="p">,</span> <span class="n">in1</span> <span class="o">=</span> <span class="n">daq</span><span class="o">.</span><span class="n">read_analog</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Analog in, channel 0 is </span><span class="si">{</span><span class="n">in0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> V and channel 1 is </span><span class="si">{</span><span class="n">in1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> V&#39;</span><span class="p">)</span>

    <span class="c1"># Note: The device reads both channels simultaneously.</span>
    <span class="c1"># If you only need one you can select it immediately with standard python:</span>
    <span class="n">read_value</span> <span class="o">=</span> <span class="n">daq</span><span class="o">.</span><span class="n">read_analog</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># Example illustrating the use of (advanced) inherited methods:</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Configure analog out channel 0&quot;</span><span class="p">)</span>
    <span class="n">ch_out</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Carrier: &quot;sine&quot;, 0.4V, 6kz, offset 1V&#39;</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeEnableSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">CARRIER</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeFunctionSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">CARRIER</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">FUNC</span><span class="o">.</span><span class="n">SINE</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeFrequencySet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">CARRIER</span><span class="p">,</span> <span class="mf">6000.0</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodePhaseSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">CARRIER</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeAmplitudeSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">CARRIER</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeOffsetSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">CARRIER</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Amplitude Modulation: &quot;ramp up&quot;, 400Hz, 100%&#39;</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeEnableSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">AM</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeFunctionSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">AM</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">FUNC</span><span class="o">.</span><span class="n">RAMP_UP</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeFrequencySet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">AM</span><span class="p">,</span> <span class="mf">400.0</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodePhaseSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">AM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeAmplitudeSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">AM</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Frequency Modulation: &quot;square&quot;, 100Hz, 20%, phase 90 degrees&#39;</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeEnableSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">FM</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeFunctionSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">FM</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">FUNC</span><span class="o">.</span><span class="n">SQUARE</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeFrequencySet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">FM</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodePhaseSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">FM</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">nodeAmplitudeSet</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">NODE</span><span class="o">.</span><span class="n">FM</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Configure analog in&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sampling rate 100kHz, 1000 points (i.e. 10ms)&#39;</span><span class="p">)</span>
    <span class="n">n_points</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">frequencySet</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Set range for all channels&quot;</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">channelRangeSet</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">bufferSizeSet</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Starting output and starting acquisition&quot;</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ao</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">ch_out</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">daq</span><span class="o">.</span><span class="n">wait_for_ai_acquisition</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   reading data&quot;</span><span class="p">)</span>
    <span class="n">scope</span> <span class="o">=</span> <span class="n">daq</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">statusData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>

    <span class="n">dc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DC: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;V&quot;</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">daq</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">bufferSizeGet</span><span class="p">())</span> <span class="o">/</span> <span class="n">daq</span><span class="o">.</span><span class="n">ai</span><span class="o">.</span><span class="n">frequencyGet</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;analog in channel 0 (V)&quot;</span><span class="p">)</span>

    <span class="c1"># to close the device:</span>
    <span class="c1"># daq.close()</span>

    <span class="c1"># or to close all devices:</span>
    <span class="c1"># close_all()</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Sanli Faez

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>